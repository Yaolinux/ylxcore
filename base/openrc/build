name=openrc
version=0.45
source=(https://github.com/OpenRC/openrc/archive/refs/tags/0.45.tar.gz)

_makeargs=(BRANDING='Yaolinux')
_makeargs+=(MKPAM=pam)
_makeargs+=(MKSELINUX=no)
_makeargs+=(MKTERMCAP=ncurses)
_makeargs+=(PKG_PREFIX="")
_makeargs+=(LIBDIR=/usr/lib)
_makeargs+=(SHLIBDIR=/usr/lib)
_makeargs+=(LIBEXECDIR=/usr/libexec/rc)
_makeargs+=(BINDIR=/usr/bin)
_makeargs+=(SBINDIR=/usr/bin)
_makeargs+=(SYSCONFDIR=/etc/openrc)

do_build() {
	cd openrc-$version

	mkdir -p ../build && cd ../build

	meson --prefix=/usr \
	-Dbranding="\"Yaolinux\"" \
        -Drootprefix=/usr \
	-Dos=Linux \
	-Dpam=true \
	-Dpkgconfig=true \
	-Dshell=/bin/bash \
        -Dsplit-usr=true \
        -Dsysvinit=true \
	-Dtermcap=ncurses \
        ../$name-$version

	ninja 
	DESTDIR=' ' ninja install

	install -vdm755 /etc/openrc/
	install -m 644 ../$name-$version/support/sysvinit/inittab /etc/openrc/inittab
	cd ..
	rm -r build/
}
